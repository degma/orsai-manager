{% extends "base.html" %}
{% block content %}
  <div class="d-flex align-items-center justify-content-between mb-3">
    <h1 class="h4 mb-0">Season stats</h1>
    <a class="btn btn-sm btn-outline-secondary" href="{{ url_for('matches.list_matches') }}">Back</a>
  </div>

  <div class="card border-0 mb-3">
    <div class="card-body">
      <div class="text-muted small">Season</div>
      <div class="fw-semibold">{{ season.year }} {{ season.term }} - {{ season.tournament.name }}</div>
      <div class="text-muted small mt-2">Total matches: {{ matches | length }}</div>
    </div>
  </div>

  <div class="card border-0 mb-3">
    <div class="card-body">
      <h3 class="h6 mb-3">Player totals (sorted by goals)</h3>
      {% if stats %}
        <div class="list-group list-group-flush">
          {% for player, games_played, goals, yellow_cards, red_cards, mvp_votes_received in stats %}
            <div class="list-group-item px-0">
              <div class="d-flex justify-content-between">
                <strong>{{ player.last_name }}, {{ player.first_name }}</strong>
                <span class="badge text-bg-primary">{{ goals }} goals</span>
              </div>
              <div class="d-flex flex-wrap gap-2 mt-2">
                <span class="badge text-bg-light text-dark">Games: {{ games_played }}</span>
                <span class="badge text-bg-light text-dark">YC: {{ yellow_cards }}</span>
                <span class="badge text-bg-light text-dark">RC: {{ red_cards }}</span>
                <span class="badge text-bg-light text-dark">MVP votes: {{ mvp_votes_received }}</span>
              </div>
            </div>
          {% endfor %}
        </div>
      {% else %}
        <p class="text-muted mb-0">No rostered players for this season.</p>
      {% endif %}
    </div>
  </div>

  <div class="card border-0">
    <div class="card-body">
      <h3 class="h6 mb-3">Matches</h3>
      {% if matches %}
        <div class="list-group list-group-flush">
          {% for match in matches %}
            <div class="list-group-item px-0">
              <div class="d-flex justify-content-between">
                <span>{{ match.date }} vs {{ match.opponent }}</span>
                <span class="badge text-bg-secondary">{{ match.status }}</span>
              </div>
              <div class="d-flex justify-content-between mt-2">
                <span class="badge text-bg-primary">{{ match.our_score }} - {{ match.their_score }}</span>
                <a class="btn btn-sm btn-outline-primary" href="{{ url_for('matches.detail', match_id=match.id) }}">View</a>
              </div>
            </div>
          {% endfor %}
        </div>
      {% else %}
        <p class="text-muted mb-0">No matches yet.</p>
      {% endif %}
    </div>
  </div>
{% endblock %}
